import{bg as x,D as u,V as r,W as d,a0 as e,ah as w,aJ as n,au as i,b6 as m,ap as a,aj as N,ai as c,aS as h}from"./index-CcJgybNG.js";import{s as U}from"./http-wojRUGQ6.js";const B={class:"page"},C={class:"form"},D={class:"full"},S=["disabled"],T={key:0,class:"error"},z={key:1,class:"result"},F={class:"summary"},R={key:0,class:"table"},W={__name:"weather-forecast",setup(j){const b=u(),y=u(1),f=u(28),g=u(5),k=u("Rain,Storm"),v=u(!1),p=u(""),s=u(null);async function _(){v.value=!0,p.value="",s.value=null;try{const o={seed:Number(b.value),clauses:[{start:Number(y.value),end:Number(f.value),min_count:Number(g.value)}]},l=k.value.trim();l&&(o.targets=l.split(",").map(V=>V.trim()).filter(Boolean));const t=await U.post("/api/weather",o);s.value=t}catch(o){p.value=o?.response?.data?.message||o?.message||"请求失败"}finally{v.value=!1}}return(o,l)=>(d(),r("div",B,[l[12]||(l[12]=e("h1",null,"天气预测 Demo",-1)),l[13]||(l[13]=e("p",{class:"desc"},[n(" 输入一个种子与规则（日期区间 + 最少命中天数）。点击查询后端接口 "),e("code",null,"/api/weather"),n("，返回是否满足（ok）以及命中的日期列表。 ")],-1)),e("div",C,[e("label",null,[l[5]||(l[5]=n(" 种子（seed）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[0]||(l[0]=t=>b.value=t)},null,512),[[m,b.value,void 0,{number:!0}]])]),e("label",null,[l[6]||(l[6]=n(" 开始日（start）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[1]||(l[1]=t=>y.value=t)},null,512),[[m,y.value,void 0,{number:!0}]])]),e("label",null,[l[7]||(l[7]=n(" 结束日（end）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[2]||(l[2]=t=>f.value=t)},null,512),[[m,f.value,void 0,{number:!0}]])]),e("label",null,[l[8]||(l[8]=n(" 最少天数（min_count）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[3]||(l[3]=t=>g.value=t)},null,512),[[m,g.value,void 0,{number:!0}]])]),e("label",D,[l[9]||(l[9]=n(" 天气类型（targets，逗号分隔，可留空）： ",-1)),i(e("input",{type:"text","onUpdate:modelValue":l[4]||(l[4]=t=>k.value=t),placeholder:"Rain,Storm 或留空用默认"},null,512),[[m,k.value]])]),e("button",{disabled:v.value,onClick:_},a(v.value?"查询中…":"查询天气"),9,S)]),p.value?(d(),r("div",T,a(p.value),1)):w("",!0),s.value?(d(),r("div",z,[e("div",F,[e("span",null,[l[10]||(l[10]=n("是否满足规则（ok）：",-1)),e("strong",{class:N({ok:s.value.ok,fail:!s.value.ok})},a(s.value.ok?"是":"否"),3)]),e("span",null,"命中天数："+a((s.value.matched_days||[]).length),1)]),(s.value.matched_days||[]).length?(d(),r("table",R,[l[11]||(l[11]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"绝对日"),e("th",null,"季节"),e("th",null,"日"),e("th",null,"天气")])],-1)),e("tbody",null,[(d(!0),r(c,null,h(s.value.matched_days,(t,V)=>(d(),r("tr",{key:t.abs_day},[e("td",null,a(V+1),1),e("td",null,a(t.abs_day),1),e("td",null,a(t.season),1),e("td",null,a(t.day),1),e("td",null,a(t.weather_zh)+" ("+a(t.weather)+")",1)]))),128))])])):w("",!0)])):w("",!0)]))}},I=x(W,[["__scopeId","data-v-0e1554ca"]]);export{I as default};
