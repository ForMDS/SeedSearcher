import{_ as x,r as u,e as r,o as d,j as e,q as w,A as n,B as i,C as m,G as a,s as N,F as B,H as C}from"./index-twOmwtBt.js";import{s as U}from"./http-E_EIyBjS.js";const c={class:"page"},h={class:"form"},D={class:"full"},F=["disabled"],S={key:0,class:"error"},T={key:1,class:"result"},q={class:"summary"},z={key:0,class:"table"},R={__name:"weather-forecast",setup(j){const b=u(),y=u(1),f=u(28),k=u(5),g=u("Rain,Storm"),v=u(!1),p=u(""),s=u(null);async function V(){v.value=!0,p.value="",s.value=null;try{const o={seed:Number(b.value),clauses:[{start:Number(y.value),end:Number(f.value),min_count:Number(k.value)}]},l=g.value.trim();l&&(o.targets=l.split(",").map(_=>_.trim()).filter(Boolean));const t=await U.post("/api/weather",o);s.value=t}catch(o){p.value=o?.response?.data?.message||o?.message||"请求失败"}finally{v.value=!1}}return(o,l)=>(d(),r("div",c,[l[12]||(l[12]=e("h1",null,"天气预测 Demo",-1)),l[13]||(l[13]=e("p",{class:"desc"},[n(" 输入一个种子与规则（日期区间 + 最少命中天数）。点击查询后端接口 "),e("code",null,"/api/weather"),n("，返回是否满足（ok）以及命中的日期列表。 ")],-1)),e("div",h,[e("label",null,[l[5]||(l[5]=n(" 种子（seed）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[0]||(l[0]=t=>b.value=t)},null,512),[[m,b.value,void 0,{number:!0}]])]),e("label",null,[l[6]||(l[6]=n(" 开始日（start）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[1]||(l[1]=t=>y.value=t)},null,512),[[m,y.value,void 0,{number:!0}]])]),e("label",null,[l[7]||(l[7]=n(" 结束日（end）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[2]||(l[2]=t=>f.value=t)},null,512),[[m,f.value,void 0,{number:!0}]])]),e("label",null,[l[8]||(l[8]=n(" 最少天数（min_count）： ",-1)),i(e("input",{type:"number","onUpdate:modelValue":l[3]||(l[3]=t=>k.value=t)},null,512),[[m,k.value,void 0,{number:!0}]])]),e("label",D,[l[9]||(l[9]=n(" 天气类型（targets，逗号分隔，可留空）： ",-1)),i(e("input",{type:"text","onUpdate:modelValue":l[4]||(l[4]=t=>g.value=t),placeholder:"Rain,Storm 或留空用默认"},null,512),[[m,g.value]])]),e("button",{disabled:v.value,onClick:V},a(v.value?"查询中…":"查询天气"),9,F)]),p.value?(d(),r("div",S,a(p.value),1)):w("",!0),s.value?(d(),r("div",T,[e("div",q,[e("span",null,[l[10]||(l[10]=n("是否满足规则（ok）：",-1)),e("strong",{class:N({ok:s.value.ok,fail:!s.value.ok})},a(s.value.ok?"是":"否"),3)]),e("span",null,"命中天数："+a((s.value.matched_days||[]).length),1)]),(s.value.matched_days||[]).length?(d(),r("table",z,[l[11]||(l[11]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"绝对日"),e("th",null,"季节"),e("th",null,"日"),e("th",null,"天气")])],-1)),e("tbody",null,[(d(!0),r(B,null,C(s.value.matched_days,(t,_)=>(d(),r("tr",{key:t.abs_day},[e("td",null,a(_+1),1),e("td",null,a(t.abs_day),1),e("td",null,a(t.season),1),e("td",null,a(t.day),1),e("td",null,a(t.weather_zh)+" ("+a(t.weather)+")",1)]))),128))])])):w("",!0)])):w("",!0)]))}},G=x(R,[["__scopeId","data-v-a55d390a"]]);export{G as default};
